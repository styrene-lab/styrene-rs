# Release Readiness Checklist

This checklist is the publication gate for the Rust workspace.

## 1. Parity truth

- LXMF parity status is tracked in `docs/plans/lxmf-parity-matrix.md`.
- Reticulum parity status is tracked in `docs/plans/reticulum-parity-matrix.md`.
- Both matrices must be updated when feature behavior or contracts change.

## 2. Contract and schema gates

- RPC contract remains aligned with `docs/contracts/rpc-contract.md`.
- Payload contract remains aligned with `docs/contracts/payload-contract.md`.
- Contract v2 schema artifacts remain valid:
  - `docs/schemas/contract-v2/payload-envelope.schema.json`
  - `docs/schemas/contract-v2/event-payload.schema.json`
- RPC contract checks in this repo and external interop gate are kept aligned with `docs/contracts/rpc-contract.md` and migration evidence.

## 3. API stability gates

- Public API surface checks pass for:
  - `lxmf-core`
  - `lxmf-sdk`
  - `rns-core`
  - `rns-transport`
  - `rns-rpc`
- Breaking changes are called out in migration docs under `docs/migrations/`.

## 4. CI quality gates

- `lint-format`
- `build-matrix` (stable + MSRV)
- `test-nextest-unit`
- `test-integration`
- `doc`
- `security`
- `crypto-agility-check`
- `key-management-check`
- `unused-deps`
- `api-surface-check`
- `compat-kit-check`
- `reference-integration-check`
- `compliance-profile-check`
- `support-policy-check`
- `unsafe-audit-check`
- `release-scorecard-check`
- `canary-criteria-check`
- `extension-registry-check`
- `architecture-lint`
- `architecture-checks`
- `changelog-migration-check`

## 5. Local release checks

```bash
cargo xtask release-check
cargo run -p rns-tools --bin rnx -- e2e --timeout-secs 20
cargo run -p rns-tools --bin rnx -- replay --trace docs/fixtures/sdk-v2/rpc/replay_known_send_cancel.v1.json
cargo run -p xtask -- sdk-bench-check
cargo run -p xtask -- sdk-perf-budget-check
cargo run -p xtask -- sdk-memory-budget-check
cargo run -p xtask -- embedded-footprint-check
cargo run -p xtask -- sdk-queue-pressure-check
cargo run -p xtask -- security-review-check
cargo run -p xtask -- sdk-fuzz-check
cargo run -p xtask -- sdk-metrics-check
cargo run -p xtask -- crypto-agility-check
cargo run -p xtask -- key-management-check
cargo run -p xtask -- sdk-docs-check
cargo run -p xtask -- sdk-cookbook-check
cargo run -p xtask -- sdk-ergonomics-check
cargo run -p xtask -- sdk-incident-runbook-check
cargo run -p xtask -- sdk-drill-check
cargo run -p xtask -- sdk-soak-check
cargo run -p xtask -- lxmf-cli-check
cargo run -p xtask -- reference-integration-check
cargo run -p xtask -- dx-bootstrap-check
cargo run -p xtask -- compat-kit-check
cargo run -p xtask -- compliance-profile-check
cargo run -p xtask -- support-policy-check
cargo run -p xtask -- unsafe-audit-check
cargo run -p xtask -- release-scorecard-check
cargo run -p xtask -- canary-criteria-check
cargo run -p xtask -- extension-registry-check
cargo run -p xtask -- architecture-lint-check
cargo run -p xtask -- architecture-checks
cargo run -p xtask -- changelog-migration-check
cargo run -p xtask -- supply-chain-check
cargo run -p xtask -- reproducible-build-check
cargo run -p xtask -- leader-readiness-check
```

Optional soak:

```bash
./tools/scripts/soak-rnx.sh
```

Nightly mesh simulation (3-10 node ring):

- Scheduled workflow: `.github/workflows/nightly-mesh.yml`
- Local dry-run command:

```bash
cargo run -p rns-tools --bin rnx -- mesh-sim --nodes 5 --timeout-secs 60
./tools/scripts/mesh-sim-rnx.sh
```

Nightly ESP32 hardware-in-loop smoke:

- Scheduled workflow: `.github/workflows/nightly-embedded-hil.yml`
- Runbook: `docs/runbooks/embedded-hil-esp32.md`
- Local gated command:

```bash
cargo run -p xtask -- embedded-hil-check
```

Queue pressure tuning and overflow policy guidance:

- `docs/runbooks/queue-pressure-tuning.md`
- `docs/runbooks/security-review-checklist.md`
- `docs/runbooks/fuzzing-campaign.md`
- `docs/runbooks/incident-response-playbooks.md`
- `docs/runbooks/disaster-recovery-drills.md`
- `docs/runbooks/soak-chaos-campaign.md`
- `docs/runbooks/compliance-profiles.md`
- `docs/runbooks/cve-response-workflow.md`
- `docs/runbooks/reference-integrations.md`

Supply-chain artifacts generated by the release gate:

- `target/supply-chain/sbom/cargo-metadata.sbom.json`
- `target/supply-chain/provenance/artifact-provenance.json`
- `target/supply-chain/provenance/artifact-provenance.sha256`
- `target/supply-chain/reproducible/reproducible-build-report.txt`

Leader-grade readiness certification artifact:

- `target/release-readiness/leader-grade-readiness.md`

Embedded footprint report artifact:

- `target/embedded/footprint-report.txt`

## 6. Canary Lane and Rollback Criteria

Canary gate command:

```bash
cargo run -p xtask -- canary-criteria-check
```

Rollback triggers (objective):

1. `overall_status != PASS` in `target/release-scorecard/release-scorecard.json`
2. `performance_status != PASS`
3. `soak_status != pass`
4. `soak_failures > 0` or `soak_mesh_failures > 0`
5. security checklist PASS rows below required floor (`CANARY_MIN_SECURITY_PASS_ROWS`, default `8`)
6. supply-chain artifact count below required floor (`CANARY_MIN_SUPPLY_CHAIN_ARTIFACTS`, default `1`)

Report artifacts:

- `target/release-readiness/canary-criteria-report.md`
- `target/release-readiness/canary-criteria-report.json`

## 7. Release metadata

- Workspace versions bumped intentionally.
- `Cargo.lock` committed for reproducible builds.
- Changelog/release notes summarize API and migration impacts.
- Relevant migration notes updated in `docs/migrations/`.
- RC execution and tagging follow `docs/runbooks/release-candidate-runbook.md`.
